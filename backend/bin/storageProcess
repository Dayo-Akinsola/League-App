#!/app/.heroku/node/bin/node

/* This process is pinged once a day by heroku scheduler and gathers data for champion stats to be updated */
const Queue = require('bull');
const Storage = require('../storage/storage.js');
const dotenv = require('dotenv');
dotenv.config();
const storeData = require('../storage/storeData');

const REDIS_URL = process.env.REDIS_URL || 'redis://127.0.0.1:6379';

const processStorage = async () => {

  const storageQueue = new Queue('storage', REDIS_URL);

  storageQueue.process(async (job, done) => {
    await storeData(newStorage);
    done();
  });

  const newStorage = Storage();

  await storageQueue.add({});
}

processStorage();






